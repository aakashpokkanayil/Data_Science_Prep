use learn46;

aLTER TABLE EMP
DROP CONSTRAINT CKDB;

USE TEST;

SELECT * FROM CJ1;
SELECT * FROM CJ2;


SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO= CJ2.RNO
UNION
SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO= CJ2.RNO;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO= CJ2.RNO
UNION ALL
SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO= CJ2.RNO;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO= CJ2.RNO
INTERSECT
SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO= CJ2.RNO;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO= CJ2.RNO
EXCEPT
SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO= CJ2.RNO;

SELECT EID, NAME, CITY FROM EMP WHERE CITY = 'PUNE'
UNION
SELECT EID, NAME, CITY FROM EMP WHERE CITY = 'MUMBAI';


SELECT * FROM EMP
WHERE CITY = 'DELHI';

SELECT * FROM EMP
WHERE ADDRESS2 = 'DWARKA';

SELECT * FROM EMP
WHERE CITY = 'DELHI' AND ADDRESS2 = 'DWARKA';

--COMPOSIT INDEX

CREATE INDEX L46I3 ON EMP (CITY, ADDRESS2);

CREATE INDEX L46I1 ON EMP (CITY);

CREATE INDEX L46I2 ON EMP (aDDRESS2);

CREATE CLUSTERED INDEX L46I4 ON EMP (DOJ);

DROP INDEX L46I3 ON EMP;

-- IMPLICT INDEX - AUTOMATICALLY CREATED - PK / UNIQUE
-- EXPLICT INDEX - WE CREATE


-- NON CLUSTERED INDEX
-- CLUSTERED INDEX

DROP VIEW L46VGGN;
CREATE VIEW L46VGGN
AS
	SELECT * FROM EMP
	WHERE CITY = 'GURGAON';

CREATE VIEW L46VGGN
AS
	SELECT * FROM EMP
	WHERE CITY = 'GURGAON'
	WITH CHECK OPTION;

SELECT * FROM L46VGGN;

INSERT INTO EMP
VALUES(1246, 'GAUTAM KAPOOR', 'TULIP GARDEN', 'SECTOR 78', 'GURGAON', '9877600909', 'GK46@YAHOO.COM', '12-JAN-1996', '05-JUL-2021');

DELETE FROM EMP WHERE EID = 1246;

INSERT INTO L46VGGN
VALUES(1246, 'GAUTAM KAPOOR', 'TULIP GARDEN', 'SECTOR 78', 'GURGAON', '9877600909', 'GK46@YAHOO.COM', '12-JAN-1996', '05-JUL-2021');

INSERT INTO L46VGGN
VALUES(1246, 'GAUTAM KAPOOR', 'TULIP GARDEN', 'SECTOR 78', 'NOIDA', '9877600909', 'GK46@YAHOO.COM', '12-JAN-1996', '05-JUL-2021');

DELETE FROM L46VGGN WHERE EID = 1246;


SELECT * FROM EMP;

CREATE VIEW L46V2
AS	
	SELECT EID, NAME,CITY,PHONENO, EMAIL, DOJ
	FROM EMP;

SELECT * FROM L46V2;

CREATE VIEW L46VSAL
AS
	SELECT EMP.EID, NAME, CITY, DOJ, DEPT, DESI, SALARY AS 'BASIC', SALARY *.15 AS 'HRA', SALARY *.09 AS 'PF'
	FROM EMP
	INNER JOIN EMP_SAL
	ON EMP.EID = EMP_SAL.EID;

SELECT * FROM L46VSAL;